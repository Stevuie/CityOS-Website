<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>CityOS Parking</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="clientside.css" />
  </head>
  <body class="cityos-body">
    <div id="root"></div>

    <script type="text/babel">
      const { useState } = React;

      function App() {
        const [currentPage, setCurrentPage] = useState("about");
        const [time, setTime] = useState("");
        const [predictionResult, setPredictionResult] = useState(null);
        const [showResult, setShowResult] = useState(false);

        const handlePrediction = async () => {
          if (!time.trim()) {
            alert("Please enter a time");
            return;
          }

          const spotId = document.getElementById('spot-id').value;
          const day = document.getElementById('day').value;
          const [hour, minute] = time.split(':');

          try {
            const response = await fetch('http://127.0.0.1:5000/predict', {
              method: 'POST',
              headers: {
                'Content-Type': 'application/json'
              },
              body: JSON.stringify({
                spot_id: spotId,
                day: day,
                hour: hour,
                minute: minute
              })
            });

            if (!response.ok) {
              throw new Error(`HTTP error! Status: ${response.status}`);
            }

            const data = await response.json();
            setPredictionResult(data.status);
            setShowResult(true);
            
            // Reset animation
            setTimeout(() => setShowResult(false), 0);
            setTimeout(() => setShowResult(true), 10);

          } catch (error) {
            console.error('Prediction error:', error);
            alert('Error getting prediction. Please make sure the ML server is running.');
          }
        };

        const Header = () => (
          <header className="cityos-header">
            <div className="cityos-header-container">
              <div className="cityos-header-flex">
                <div className="cityos-header-logo-group">
                  <svg
                    className="cityos-logo"
                    fill="currentColor"
                    viewBox="0 0 20 20"
                  >
                    <path d="M8 16.5a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0zM15 16.5a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0z" />
                    <path d="M3 4a1 1 0 00-1 1v10a1 1 0 001 1h1.05a2.5 2.5 0 014.9 0H10a1 1 0 001-1V5a1 1 0 00-1-1H3zM14 7a1 1 0 00-1 1v6.05A2.5 2.5 0 0115.95 16H17a1 1 0 001-1V8a1 1 0 00-1-1h-3z" />
                  </svg>
                  <h1 className="cityos-header-title">
                    <span className="italic-text">City</span>OS Parking
                  </h1>
                </div>
                <nav className="cityos-header-nav">
                  <button
                    onClick={() => setCurrentPage("about")}
                    className={`cityos-btn cityos-btn-nav${
                      currentPage === "about" ? " cityos-btn-nav-active" : ""
                    }`}
                  >
                    About Us
                  </button>
                  <button
                    onClick={() => setCurrentPage("predictor")}
                    className={`cityos-btn cityos-btn-nav${
                      currentPage === "predictor"
                        ? " cityos-btn-nav-active"
                        : ""
                    }`}
                  >
                    Parking Predictor
                  </button>
                </nav>
              </div>
            </div>
          </header>
        );

        const AboutPage = () => (
          <div className="cityos-main">
            <section className="cityos-hero">
              <div className="cityos-hero-center">
                <h1 className="cityos-hero-title">
                  Intelligent Parking for{" "}
                  <span className="cityos-highlight">Smarter Cities</span>
                </h1>
              </div>
            </section>
            <section className="cityos-team">
              <div className="cityos-team-container">
                <h2 className="cityos-team-title">Mission Statement</h2>
                <p className="cityos-hero-desc">
                  <span className="italic-text">City</span>OS is a project
                  developed under the guidance of Dr. Jorge Ortiz at WINLAB,
                  Rutgers University. Our goal is to leverage computer vision
                  and machine learning to create a smart parking system that
                  predicts parking availability, reducing congestion and
                  improving urban life.
                  Lorem, ipsum dolor sit amet consectetur adipisicing elit. Excepturi illum, blanditiis accusamus non magnam consectetur nisi repudiandae animi libero pariatur perferendis error, sapiente qui eaque! Adipisci laudantium magnam sunt voluptatum.
                  Lorem, ipsum dolor sit amet consectetur adipisicing elit. Ipsa illo a obcaecati odio eum iusto incidunt placeat aspernatur error veniam nobis culpa maxime, pariatur repellendus dolores perspiciatis sunt? Rem, perferendis?
                  !!placeholder text!!
                </p>
                <h2 className="cityos-team-title">Our Team</h2>
                <div className="cityos-team-grid">
                  {[
                    {
                      name: "Aryan Upadhyay",
                      description:
                        "Rising sophomore at Rutgers University, double majoring in Computer Science and Data Science.",
                      avatar: "images/avatars/aryan.png",
                    },
                    {
                      name: "Rohan Sada",
                      description:
                        "Pursuing a Master's degree in Electrical and Computer Engineering at Rutgers University, specializing in Machine Learning.",
                      avatar: "images/avatars/rohan.png",
                    },
                    {
                      name: "Steven Huang",
                      description:
                        "Rising junior at Rutgers University, pursuing a B.S. in Electrical Engineering and a minor in Computer Science.",
                      avatar: "images/avatars/steven.png",
                    },
                  ].map((member, index) => (
                    <div key={index} className="cityos-team-card">
                      <img
                        src={member.avatar}
                        alt={member.name}
                        className="cityos-team-avatar"
                        onError={(e) => {
                          e.target.src =
                            "https://placehold.co/400x400/27272a/fafafa?text=" +
                            member.name
                              .split(" ")
                              .map((n) => n[0])
                              .join("");
                        }}
                      />
                      <h3 className="cityos-team-name">{member.name}</h3>
                      <p className="cityos-team-desc">{member.description}</p>
                    </div>
                  ))}
                </div>
              </div>
            </section>
            <section className="cityos-timeline">
              <div className="cityos-timeline-container">
                <h2 className="cityos-timeline-title">Our Progress</h2>
                <div className="cityos-timeline-list">
                  {[
                    {
                      week: "Week 1",
                      date: "June 5, 2025",
                      accomplishments: [
                        "Met with Dr. Ortiz to define project scope.",
                        "Narrowed focus to a smart car parking system.",
                        "Began research into data regression models and project documentation.",
                      ],
                    },
                    {
                      week: "Week 2",
                      date: "June 11, 2025",
                      accomplishments: [
                        "Drafted the detailed system design document.",
                        "Obtained video feed of the parking lot and applied YOLOv8 for object detection.",
                        "Outlined the system architecture, including the Data Logger, ML Model Trainer, and Prediction API.",
                      ],
                    },
                    {
                      week: "Week 3",
                      date: "June 18, 2025",
                      accomplishments: [
                        "Implemented and tested three initial ML models: Linear Regression, Naive Bayes, and Gradient Boosting.",
                        "Achieved initial prediction results on sample data.",
                        "Began learning about Decision Tree and Random Forest algorithms for future implementation.",
                      ],
                    },
                  ].map((week, index) => (
                    <div key={index} className="cityos-timeline-card">
                      <div className="cityos-timeline-header">
                        <h3 className="cityos-timeline-week">{week.week}</h3>
                        <span className="cityos-timeline-date">
                          {week.date}
                        </span>
                      </div>
                      <ul className="cityos-timeline-ul">
                        {week.accomplishments.map((item, itemIndex) => (
                          <li key={itemIndex} className="cityos-timeline-li">
                            <span className="cityos-timeline-dot">•</span>
                            <span className="cityos-timeline-text">{item}</span>
                          </li>
                        ))}
                      </ul>
                    </div>
                  ))}
                </div>
              </div>
            </section>
          </div>
        );

        const PredictorPage = () => (
          <div className="min-h-screen flex items-center justify-center px-4 sm:px-6 lg:px-8">
            <div className="max-w-md w-full space-y-8">
              <div className="text-center">
                <h1 className="text-3xl sm:text-4xl font-bold text-white mb-8">
                  Parking Availability Predictor
                </h1>
              </div>
              
              <div className="bg-slate-800 rounded-lg p-8 shadow-xl">
                <div className="space-y-6">
                  <div>
                    <label htmlFor="spot-id" className="block text-sm font-medium text-gray-300 mb-2">
                      Select Parking Spot
                    </label>
                    <select
                      id="spot-id"
                      className="w-full px-4 py-3 bg-slate-700 border border-slate-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors duration-200"
                    >
                      <option value="spot_1">Spot 1</option>
                      <option value="spot_2">Spot 2</option>
                      <option value="spot_3">Spot 3</option>
                      <option value="spot_4">Spot 4</option>
                      <option value="spot_5">Spot 5</option>
                      <option value="spot_6">Spot 6</option>
                      <option value="spot_10">Spot 10</option>
                      <option value="spot_12">Spot 12</option>
                      <option value="spot_13">Spot 13</option>
                      <option value="spot_14">Spot 14</option>
                    </select>
                  </div>

                  <div>
                    <label htmlFor="day" className="block text-sm font-medium text-gray-300 mb-2">
                      Select Day
                    </label>
                    <select
                      id="day"
                      className="w-full px-4 py-3 bg-slate-700 border border-slate-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors duration-200"
                    >
                      <option value="Monday">Monday</option>
                      <option value="Tuesday">Tuesday</option>
                      <option value="Wednesday">Wednesday</option>
                      <option value="Thursday">Thursday</option>
                      <option value="Friday">Friday</option>
                      <option value="Saturday">Saturday</option>
                      <option value="Sunday">Sunday</option>
                    </select>
                  </div>

                  <div>
                    <label htmlFor="time" className="block text-sm font-medium text-gray-300 mb-2">
                      Enter Time
                    </label>
                    <input
                      type="time"
                      id="time"
                      onChange={(e) => setTime(e.target.value)}
                      className="w-full px-4 py-3 bg-slate-700 border border-slate-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors duration-200"
                    />
                  </div>
                  
                  <button
                    onClick={handlePrediction}
                    className="w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 px-6 rounded-lg transition-colors duration-200 transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-blue-500"
                  >
                    Check Availability
                  </button>
                  
                  <div className="min-h-[80px] flex items-center justify-center">
                    {predictionResult ? (
                      <div className={`${showResult ? 'fade-in' : ''} w-full p-4 rounded-lg flex items-center justify-center space-x-3 ${
                        predictionResult === 'Free' 
                          ? 'bg-green-900/50 border border-green-500 text-green-400' 
                          : 'bg-red-900/50 border border-red-500 text-red-400'
                      }`}>
                        {predictionResult === 'Free' ? (
                          <svg className="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                            <path fillRule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clipRule="evenodd"/>
                          </svg>
                        ) : (
                          <svg className="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                            <path fillRule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clipRule="evenodd"/>
                          </svg>
                        )}
                        <span className="text-lg font-semibold">
                          Parking is {predictionResult}
                        </span>
                      </div>
                    ) : (
                      <p className="text-gray-400 text-center">
                        Enter a time to check parking availability
                      </p>
                    )}
                  </div>
                </div>
              </div>
            </div>
          </div>
        );

        return (
          <div className="cityos-app">
            <div className="background">
              <Header />
              {currentPage === "about" ? <AboutPage /> : <PredictorPage />}
            </div>
          </div>
        );
      }

      ReactDOM.render(<App />, document.getElementById("root"));
    </script>

  </body>
</html>
